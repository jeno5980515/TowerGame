var c;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)}}();
var backGroundLeftOneCanvas=document.createElement("canvas"),backGroundLeftOneCtx=backGroundLeftOneCanvas.getContext("2d"),backGroundRightOneCanvas=document.createElement("canvas"),backGroundRightOneCtx=backGroundRightOneCanvas.getContext("2d"),backGroundLeftTwoCanvas=document.createElement("canvas"),backGroundLeftTwoCtx=backGroundLeftTwoCanvas.getContext("2d"),backGroundRightTwoCanvas=document.createElement("canvas"),backGroundRightTwoCtx=backGroundRightTwoCanvas.getContext("2d"),goalTagRightCanvas=
document.createElement("canvas"),goalTagRightCtx=goalTagRightCanvas.getContext("2d"),nowTagRightCanvas=document.createElement("canvas"),nowTagRightCtx=nowTagRightCanvas.getContext("2d"),goalTagLeftCanvas=document.createElement("canvas"),goalTagLeftCtx=goalTagLeftCanvas.getContext("2d"),nowTagLeftCanvas=document.createElement("canvas"),nowTagLeftCtx=nowTagLeftCanvas.getContext("2d"),tagTopRightCanvas=document.createElement("canvas"),tagTopRightCtx=tagTopRightCanvas.getContext("2d"),tagDownRightCanvas=
document.createElement("canvas"),tagDownRightCtx=tagDownRightCanvas.getContext("2d"),tagTopLeftCanvas=document.createElement("canvas"),tagTopLeftCtx=tagTopLeftCanvas.getContext("2d"),tagDownLeftCanvas=document.createElement("canvas"),tagDownLeftCtx=tagDownLeftCanvas.getContext("2d"),stage1Canvas=document.createElement("canvas"),stage1Ctx=stage1Canvas.getContext("2d"),stage2Canvas=document.createElement("canvas"),stage2Ctx=stage2Canvas.getContext("2d"),stage3Canvas=document.createElement("canvas"),
stage3Ctx=stage3Canvas.getContext("2d"),stage4Canvas=document.createElement("canvas"),stage4Ctx=stage4Canvas.getContext("2d"),stage5Canvas=document.createElement("canvas"),stage5Ctx=stage5Canvas.getContext("2d"),beginCount,cacheMap={},hookCache={},pigIndex=0,nextCache={};document.getElementById("bg").src="sound/background.mp3";document.getElementById("fail").src="sound/fail.mp3";document.getElementById("win").src="sound/win.mp3";document.getElementById("box").src="sound/box.mp3";
document.getElementById("button").src="sound/button.mp3";
var imageList="hook hook2 box1 box2 game_bg_1 game_bg_2 game_bg2_1 game_bg2_2 0 1 2 3 4 5 6 7 8 9 02 12 22 32 42 52 62 72 82 92 M tag tag2 tag3 tag_2 tag3_2 nowtag goaltag nowtag2 goaltag2 box_small box_small2 box_small3 box_mid box_mid2 base box_big box_big2 box_super box_super2 box_other box_other2 box_other3 box_other4 fail again again2 win next next2 return return2 teach teach_button teach_button2 start start2 teach2 teach3 teach4 teach5 new new2 pig pig2 continue continue2 rank rank2 index shovel shovel2 teach_bg new_return new_return2 new_continue new_continue2 rank_bg confirm confirm2 input lv_bg lv1 lv1_2 lv1_3 lv2 lv2_2 lv2_3 lv3 lv3_2 lv3_3 lv4 lv4_2 lv4_3 lv5 lv5_2 lv5_3 stage1 stage2 stage3 stage4 stage5".split(" "),simpleBoxList=
["box_big","box_big2","box_super","box_super2"],allBoxList="box_small box_small2 box_small3 box_mid box_mid2 box_big box_big2 box_super box_super2 box_other box_other2 box_other3 box_other4".split(" "),normalBoxList="box_small box_small2 box_small3 box_mid box_mid2 box_big box_big2 box_super box_super2 box_other box_other2 box_other3".split(" "),randomType=1,leftTower=[],rightTower=[],imageMap={},resulotion,width,heigth,ctx,nowPage="index",boxList=[],hasFirstBox=!1,isGameOver=!1,viewWidth=1500,viewHeight=
780,upperBound=600,upperBound2=550,reloadTimer,leftMax,rightMax,hookMoveSpeed=5,hookAngleSpeed=.02,hookload=!0,FirstEnterPage=!0,nextBox,remainTime=120,countTimer,nowHeight=0,isBoxTouch=!1,addHeightTimer,addLeftHeightTimer,addRightHeightTimer,remainHeight,remainLeftHeight,remainRightHeight,goalHeight=3,nowLeftHeight,nowRightHeight,isPush=!1,isWin=!1,amount,mouseOver="none",spin=!0,isTeach=!1,isTeaching=!1,isContinue=!1,isShowConfirm=!1,rankSite,inputBox=[],total=0,buttonSound=!1,winSound=!1,failSound=
!1,boxSound=!1,lastBox={x:0,y:0},hook,hookBox,boxType={},IE="ActiveXObject"in window,pageTimer,world,getNextPage=function(){if("stage1"===nowPage)return"stage2";if("stage2"===nowPage)return"stage3";if("stage3"===nowPage)return"stage4";if("stage4"===nowPage)return"stage5"},showStage=function(){"stage1"===nowPage?(void 0===stage1Ctx.cache&&(stage1Canvas.width=140,stage1Canvas.height=70,stage1Ctx.drawImage(getImage("stage1"),0,0,140,70),stage1Ctx.cache=!0),ctx.drawImage(stage1Ctx.canvas,800,50)):"stage2"===
nowPage?(void 0===stage2Ctx.cache&&(stage2Canvas.width=140,stage2Canvas.height=70,stage2Ctx.drawImage(getImage("stage2"),0,0,140,70),stage2Ctx.cache=!0),ctx.drawImage(stage2Ctx.canvas,800,50)):"stage3"===nowPage?(void 0===stage3Ctx.cache&&(stage3Canvas.width=140,stage3Canvas.height=70,stage3Ctx.drawImage(getImage("stage3"),0,0,140,70),stage3Ctx.cache=!0),ctx.drawImage(stage3Ctx.canvas,800,50)):"stage4"===nowPage?(void 0===stage4Ctx.cache&&(stage4Canvas.width=140,stage4Canvas.height=70,stage4Ctx.drawImage(getImage("stage4"),
0,0,140,70),stage4Ctx.cache=!0),ctx.drawImage(stage4Ctx.canvas,800,50)):"stage5"===nowPage&&(void 0===stage5Ctx.cache&&(stage5Canvas.width=140,stage5Canvas.height=70,stage5Ctx.drawImage(getImage("stage5"),0,0,140,70),stage5Ctx.cache=!0),ctx.drawImage(stage5Ctx.canvas,800,50))},saveData=function(){var b=Cookies.get(nowPage);(null===b||""===b||void 0===b||parseInt(b)<remainTime)&&Cookies.set(nowPage,remainTime,{expires:36500});b=Cookies.get(getNextPage());null!==b&&""!==b&&void 0!==b||Cookies.set(getNextPage(),
0,{expires:36500})},setMouseEvent=function(b,d){document.onclick=d;document.onmousemove=b;document.ontouchend=d},getMouseSite=function(b){var d;IE?(d=event.clientX+document.body.scrollLeft,b=event.clientY+document.body.scrollTop):(d=b.pageX,b=b.pageY);return{x:d,y:b}},getRatio=function(b,d){var g=978/780,h;g>b/d?(h=b/g,g=b):(g*=d,h=d);return{w:g,h:h}},showTeachMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,
e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-388*f/978-(g-f)/2)<=73*f/978&&Math.abs(d-418*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="pointer",mouseOver="start",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},showTeachMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,
e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-388*f/978-(g-f)/2)<=73*f/978&&Math.abs(d-418*e/780-(h-e)/2)<=31*e/780?(isTeaching=isTeach=!1,mouseOver="none",beginCountTime()):mouseOver="none"},fixLeftAndRight=function(){if(leftMax.state.pos.x>rightMax.state.pos.x){var b=leftMax;leftMax=rightMax;rightMax=b}},makeType=function(b,d,g){return{width:b,height:d,size:g}},detectPoly=function(b){return"box_other"===b||"box_other2"===b||"box_other3"===b||"box_other4"===b?!0:!1},makeBoxType=function(){boxType.base=
makeType(139,119,5);boxType.box_super=makeType(218,90,5);boxType.box_super2=makeType(218,75,4);boxType.box_big=makeType(179,90,5);boxType.box_big2=makeType(179,75,4);boxType.box_mid=makeType(139,119,5);boxType.box_mid2=makeType(139,104,4);boxType.box_small=makeType(139,89,5);boxType.box_small2=makeType(139,76,4);boxType.box_small3=makeType(129,89,5);boxType.box_other=makeType(203,69,4);boxType.box_other2=makeType(203,69,4);boxType.box_other3=makeType(119,89,5);boxType.box_other4=makeType(119,89,5)},
showBlock=function(){ctx.fillStyle="white";ctx.fillRect(0,0,c.width/2-470,c.height);ctx.fillRect(c.width-(c.width/2-470),0,c.width/2-470,c.height)},showTag=function(){1===amount?(void 0===tagTopRightCanvas.cache&&(tagTopRightCanvas.width=37,tagTopRightCanvas.height=18,tagTopRightCtx.drawImage(getImage("tag"),0,0,37,18),tagTopRightCanvas.cache=!0),ctx.drawImage(tagTopRightCanvas,742,738-510*nowHeight/goalHeight),ctx.drawImage(getImage("tag2"),742,712-510*nowHeight/goalHeight+43,37,510*nowHeight/goalHeight),
void 0===tagDownRightCanvas.cache&&(tagDownRightCanvas.width=37,tagDownRightCanvas.height=19,tagDownRightCtx.drawImage(getImage("tag3"),0,0,37,19),tagDownRightCanvas.cache=!0),ctx.drawImage(tagDownRightCanvas,742,755)):2===amount&&(void 0===tagTopRightCanvas.cache&&(tagTopRightCanvas.width=37,tagTopRightCanvas.height=18,tagTopRightCtx.drawImage(getImage("tag"),0,0,37,18),tagTopRightCanvas.cache=!0),ctx.drawImage(tagTopRightCanvas,744,738-516*nowRightHeight/goalHeight),ctx.drawImage(getImage("tag2"),
744,712-516*nowRightHeight/goalHeight+43,35,516*nowRightHeight/goalHeight),void 0===tagDownRightCanvas.cache&&(tagDownRightCanvas.width=37,tagDownRightCanvas.height=19,tagDownRightCtx.drawImage(getImage("tag3"),0,0,37,19),tagDownRightCanvas.cache=!0),ctx.drawImage(tagDownRightCanvas,744,755),void 0===tagTopLeftCanvas.cache&&(tagTopLeftCanvas.width=35,tagTopLeftCanvas.height=18,tagTopLeftCtx.drawImage(getImage("tag_2"),0,0,35,18),tagTopLeftCanvas.cache=!0),ctx.drawImage(tagTopLeftCanvas,22,738-516*
nowLeftHeight/goalHeight),ctx.drawImage(getImage("tag2"),22,712-516*nowLeftHeight/goalHeight+43,35,516*nowLeftHeight/goalHeight),void 0===tagDownLeftCanvas.cache&&(tagDownLeftCanvas.width=35,tagDownLeftCanvas.height=19,tagDownLeftCtx.drawImage(getImage("tag3_2"),0,0,35,19),tagDownLeftCanvas.cache=!0),ctx.drawImage(tagDownLeftCanvas,22,755))},showNowTag=function(){if(1===amount){void 0===nowTagRightCanvas.cache&&(nowTagRightCanvas.width=95,nowTagRightCanvas.height=32,nowTagRightCtx.drawImage(getImage("nowtag"),
0,0,95,32),nowTagRightCanvas.cache=!0);ctx.drawImage(nowTagRightCanvas,635,739-511*nowHeight/goalHeight);var b=675+8*(nowHeight.toString().length-1),d=nowHeight;ctx.drawImage(getImage("M"),b,745-511*nowHeight/goalHeight,15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,745-511*nowHeight/goalHeight,15,20),d=Math.floor(d/10),b-=16,0!==d););}else if(2===amount){void 0===nowTagRightCanvas.cache&&(nowTagRightCanvas.width=95,nowTagRightCanvas.height=32,nowTagRightCtx.drawImage(getImage("nowtag"),
0,0,95,32),nowTagRightCanvas.cache=!0);ctx.drawImage(nowTagRightCanvas,645,738-516*nowRightHeight/goalHeight);b=685+8*(nowRightHeight.toString().length-1);d=nowRightHeight;ctx.drawImage(getImage("M"),b,744-516*nowRightHeight/goalHeight,15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,744-516*nowRightHeight/goalHeight,15,20),d=Math.floor(d/10),b-=16,0!==d););void 0===nowTagLeftCanvas.cache&&(nowTagLeftCanvas.width=95,nowTagLeftCanvas.height=32,nowTagLeftCtx.drawImage(getImage("nowtag2"),
0,0,95,32),nowTagLeftCanvas.cache=!0);ctx.drawImage(nowTagLeftCanvas,62,738-516*nowLeftHeight/goalHeight);b=115+8*(nowLeftHeight.toString().length-1);d=nowLeftHeight;ctx.drawImage(getImage("M"),b,744-516*nowLeftHeight/goalHeight,15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,744-516*nowLeftHeight/goalHeight,15,20),d=Math.floor(d/10),b-=16,0!==d););}},showGoalTag=function(){if(1===amount){void 0===goalTagRightCanvas.cache&&(goalTagRightCanvas.width=95,goalTagRightCanvas.height=32,goalTagRightCtx.drawImage(getImage("goaltag"),
0,0,95,32),goalTagRightCanvas.cache=!0);ctx.drawImage(goalTagRightCanvas,635,236);var b=675+8*(goalHeight.toString().length-1),d=goalHeight;ctx.drawImage(getImage("M"),b,242,15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,242,15,20),d=Math.floor(d/10),b-=16,0!==d););}else if(2===amount){void 0===goalTagRightCanvas.cache&&(goalTagRightCanvas.width=95,goalTagRightCanvas.height=32,goalTagRightCtx.drawImage(getImage("goaltag"),0,0,95,32),goalTagRightCanvas.cache=!0);ctx.drawImage(goalTagRightCanvas,
645,230);b=685+8*(goalHeight.toString().length-1);d=goalHeight;ctx.drawImage(getImage("M"),b,236,15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,236,15,20),d=Math.floor(d/10),b-=16,0!==d););void 0===goalTagLeftCanvas.cache&&(goalTagLeftCanvas.width=95,goalTagLeftCanvas.height=32,goalTagLeftCtx.drawImage(getImage("goaltag2"),0,0,95,32),goalTagLeftCanvas.cache=!0);ctx.drawImage(goalTagLeftCanvas,62,230);b=115+8*(goalHeight.toString().length-1);d=goalHeight;ctx.drawImage(getImage("M"),b,236,
15,20);for(b-=16;0<=d&&(ctx.drawImage(getImage(d%10+"2"),b,236,15,20),d=Math.floor(d/10),b-=16,0!==d););}},showGoalHeight=function(){1===amount?(ctx.font="30px Arial",ctx.fillStyle="#C5453E",ctx.fillText(goalHeight+" m",855-10*goalHeight.toString().length,220,300,50)):2===amount&&(ctx.font="30px Arial",ctx.fillStyle="#C5453E",ctx.fillText(goalHeight+" m",855-10*goalHeight.toString().length,187,300,50),ctx.fillText(goalHeight+" m",855-10*goalHeight.toString().length,365,300,50))},showNowHeight=function(){1===
amount?(ctx.font="30px Arial",ctx.fillStyle="#28231E",ctx.fillText(nowHeight+" m",855-10*nowHeight.toString().length,320,300,50)):2===amount&&(ctx.font="30px Arial",ctx.fillStyle="#28231E",ctx.fillText(nowLeftHeight+" m",855-10*nowLeftHeight.toString().length,260,300,50),ctx.fillText(nowRightHeight+" m",855-10*nowRightHeight.toString().length,438,300,50))},countTime=function(){0>=remainTime?toGameOver():--remainTime},showTime=function(){if(1===amount)for(var b=825+25*remainTime.toString().length,
d=remainTime;0<=d&&(ctx.drawImage(getImage(d%10),b,420,50,50),d=Math.floor(d/10),b-=50,0!==d););else if(2===amount)for(b=820+25*remainTime.toString().length,d=remainTime;0<=d&&(ctx.drawImage(getImage(d%10),b,525,50,50),d=Math.floor(d/10),b-=50,0!==d););},randomBox=function(){0===randomType?nextBox=simpleBoxList[Math.floor(Math.random()*simpleBoxList.length)]:1===randomType?nextBox=allBoxList[Math.floor(Math.random()*allBoxList.length)]:2===randomType&&(nextBox=normalBoxList[Math.floor(Math.random()*
normalBoxList.length)])},showNext=function(){if(1===amount){if(void 0===nextCache[nextBox]){var b=document.createElement("canvas");b.width=70*boxType[nextBox].width/100;b.height=70*boxType[nextBox].height/100;var d=b.getContext("2d");d.drawImage(getImage(nextBox),0,0,b.width,b.height);nextCache[nextBox]=b}ctx.drawImage(nextCache[nextBox],860-30*boxType[nextBox].width/100,600)}else 2===amount&&(void 0===nextCache[nextBox]&&(b=document.createElement("canvas"),b.width=70*boxType[nextBox].width/100,b.height=
70*boxType[nextBox].height/100,d=b.getContext("2d"),d.drawImage(getImage(nextBox),0,0,b.width,b.height),nextCache[nextBox]=b),ctx.drawImage(nextCache[nextBox],860-30*boxType[nextBox].width/100,680))},createBox=function(b,d,g,h,e,f,m){return Physics.body(b,{x:d,y:g,width:h,height:e,treatment:f,view:m})},createPoly=function(b,d,g,h,e,f,m,k){g=[];"box_other"===d?g=[{x:0,y:67},{x:35,y:0},{x:202,y:0},{x:171,y:67}]:"box_other2"===d?g=[{x:0,y:67},{x:35,y:0},{x:202,y:0},{x:171,y:67}]:"box_other3"===d?g=[{x:0,
y:0},{x:20,y:77},{x:100,y:77},{x:118,y:0}]:"box_other4"===d&&(g=[{x:21,y:0},{x:0,y:88},{x:118,y:88},{x:100,y:0}]);return Physics.body(b,{vertices:g,treatment:m,view:k})},makeImage=function(b){var d=new Image;d.src="img/"+b+".png";imageMap[b]=d},makeAllImage=function(){for(var b=0;b<imageList.length;b++)makeImage(imageList[b])},getImage=function(b){return imageMap[b]},drawBody=function(b,d,g,h){if("hook"===b.label){var e=b.state.pos,f=b.offset,m=b.state.vel,k=this._interpolateTime||0,l,k=b.state.angular.pos+
b.state.angular.vel*k,f=hookCache[k];void 0!==f?g.drawImage(f,b.state.pos.x-f.width/2,b.state.pos.y-f.height/2):(f=document.createElement("canvas"),f.width=2*d.width,f.height=2*d.height,l=f.getContext("2d"),l.save(),l.translate(d.width/2,d.height/2),l.translate(d.width/2,d.height/2),l.rotate(k),l.translate(-d.width/2,-d.height/2),l.drawImage(d,0,0,d.width,d.height),l.restore(),g.drawImage(f,b.state.pos.x-f.width/2,b.state.pos.y-f.height/2),hookCache[k]=f)}else e=b.state.pos,f=b.offset,m=b.state.vel,
k=this._interpolateTime||0,h=h||this.options.offset,l=e._[0]+h.x+m._[0]*k,h=e._[1]+h.y+m._[1]*k,k=b.state.angular.pos+b.state.angular.vel*k,g.save(),g.translate(l,h),g.rotate(k),g.translate(f._[0],f._[1]),g.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),g.restore()},isFirst=function(){null!==Cookies.get("stage1")&&""!==Cookies.get("stage1")&&void 0!==Cookies.get("stage1")?isContinue=!0:(Cookies.set("theRank0",{name:"boss",score:99999}),Cookies.set("theRank1",{name:"king",score:35}),Cookies.set("theRank2",
{name:"happycat",score:30}),Cookies.set("theRank3",{name:"francis",score:25}),Cookies.set("theRank4",{name:"Amy",score:20}),Cookies.set("theRank5",{name:"123",score:15}),Cookies.set("theRank6",{name:"handsome",score:10}))},init=function(){document.getElementById("bg").play();isFirst();makeAllImage();makeBoxType();SlEEPBAG.canvasAutoResizer.load(function(b){b.canvasWidth=978;b.canvasHeight=780;b=b.getGameArea();document.body.appendChild(b)});c=SlEEPBAG.canvasAutoResizer.getGameCanvas();resulotion=
SlEEPBAG.canvasAutoResizer.getResolution();width=c.width;height=c.height;ctx=c.getContext("2d");ctx.font="30px Arial";resetAll();changePage()},beginCountTime=function(){!1===isTeach&&!1===isTeaching&&!1===beginCount&&(countTimer=setInterval(countTime,1E3),beginCount=!0)},resetAll=function(){pigIndex=0;ctx.font="30px Arial";failSound=winSound=boxSound=isBoxTouch=isPush=beginCount=!1;isFirst();mouseOver="none";"stage1"===nowPage?(isTeaching=isTeach=!0,amount=1,randomType=0,goalHeight=60,remainTime=
70):"stage2"===nowPage?(isTeach=!0,isTeaching=!1,randomType=amount=1,goalHeight=60,remainTime=70):"stage3"===nowPage?(isTeach=!0,isTeaching=!1,amount=2,randomType=1,goalHeight=40,remainTime=80):"stage4"===nowPage?(isTeach=!0,isTeaching=!1,amount=1,randomType=2,goalHeight=70,remainTime=120):"stage5"===nowPage&&(isTeach=!0,isTeaching=!1,randomType=amount=2,goalHeight=50,remainTime=120);void 0!==world&&world.destroy();world=Physics(function(b){var g=Physics.aabb(0,0,viewWidth,2*viewHeight);Physics.util.ticker.on(function(g,
e){b.step(g)});Physics.util.ticker.start();b.add([Physics.behavior("edge-collision-detection",{aabb:g,restitution:0}),Physics.behavior("body-impulse-response"),Physics.behavior("constant-acceleration",{acc:{x:0,y:.001}}),Physics.behavior("body-collision-detection"),Physics.behavior("sweep-prune")])});world.on("collisions:detected",function(b){for(var g,h=0,e=b.collisions.length;h<e;h++){g=b.collisions[h];var f=g.bodyA.uid,m=g.bodyB.uid;if("floor"===g.bodyA.label||"floor"===g.bodyB.label){!1===isGameOver&&
toGameOver();break}f>m?(g.bodyA.state.vel.y=0,void 0===g.bodyA.uidB&&(document.getElementById("box").play(),g.bodyA.uidB=!0),g.bodyA.state.vel.y=.01,g.bodyA.state.vel.y=0):(g.bodyB.state.vel.y=0,void 0===g.bodyB.uidA&&(document.getElementById("box").play(),g.bodyB.uidA=!0),g.bodyB.state.vel.y=.01,g.bodyB.state.vel.y=0)}});isShowConfirm=!1;hookload=!0;isGameOver=isWin=!1;leftTower=[];rightTower=[];boxList=[];remainRightHeight=remainLeftHeight=remainHeight=nowRightHeight=nowLeftHeight=nowHeight=0;hasFirstBox=
!1;hook=createBox("rectangle",300,54,-100,-100,"static",getImage("hook"));hook.state.angular.pos=Math.PI/2;hook.label="hook";var b;0===randomType?b=simpleBoxList[Math.floor(Math.random()*simpleBoxList.length)]:1===randomType?b=allBoxList[Math.floor(Math.random()*allBoxList.length)]:2===randomType&&(b=normalBoxList[Math.floor(Math.random()*normalBoxList.length)]);hookBox=!1===detectPoly(b)?createBox("rectangle",0,0,boxType[b].width,boxType[b].height,"static",getImage(b)):createPoly("convex-polygon",
b,0,0,boxType[b].width,boxType[b].height,"static",getImage(b));hookBox.state.vel.y=0;hookBox.restitution=0;hookBox.size=boxType[a].size;hookBox.cof=3;hookBox.label="box";world.add(hook);world.add(hookBox);FirstEnterPage=!0;clearTimeout(reloadTimer);clearTimeout(countTimer);clearTimeout(addHeightTimer);clearTimeout(addLeftHeightTimer);clearTimeout(addRightHeightTimer)},initFirstBox=function(){if(!0!==hasFirstBox)if(1===amount){var b=createBox("rectangle",viewWidth/2-360,viewHeight-50,boxType.base.width,
boxType.base.height,"static",getImage("base"));world.add(b);boxList.push(b);hasFirstBox=!0}else 2===amount&&(b=createBox("rectangle",250,viewHeight-50,boxType.base.width,boxType.base.height,"static",getImage("base")),world.add(b),leftMax=b,leftTower.push(b),b=createBox("rectangle",550,viewHeight-50,boxType.base.width,boxType.base.height,"static",getImage("base")),world.add(b),rightMax=b,rightTower.push(b),hasFirstBox=!0)},addFloor=function(){if(!0!==hasFirstBox){var b=createBox("rectangle",-100,viewHeight+
5,3*viewWidth,10,"static",getImage("box1"));b.hide=!0;b.label="floor";world.add(b);1===amount?boxList.push(b):(leftTower.push(b),rightTower.push(b))}},moveUp=function(){if(1===amount){if(upperBound=600,boxList[boxList.length-1].state.pos.y<=upperBound&&0===boxList[boxList.length-1].state.vel.y){for(var b=0;b<boxList.length;b++)boxList[b].treatment="static";for(b=0;b<boxList.length;b++)boxList[b].state.pos.y+=2;for(b=0;b<boxList.length;b++){var d=getH(boxList[b]);viewHeight-boxList[b].state.pos.y>
d&&(boxList[b].treatment="dynamic")}}}else if(2===amount&&(upperBound=550,leftTower[leftTower.length-1].state.pos.y<=upperBound&&0===leftTower[leftTower.length-1].state.vel.y||rightTower[rightTower.length-1].state.pos.y<=upperBound&&0===rightTower[rightTower.length-1].state.vel.y)){for(b=0;b<leftTower.length;b++)leftTower[b].state.vel.y=0,leftTower[b].treatment="static";for(b=0;b<rightTower.length;b++)rightTower[b].state.vel.y=0,rightTower[b].treatment="static";for(b=0;b<leftTower.length;b++)leftTower[b].state.pos.y+=
2;for(b=0;b<rightTower.length;b++)rightTower[b].state.pos.y+=2;for(b=0;b<leftTower.length;b++)d=getH(leftTower[b]),viewHeight-leftTower[b].state.pos.y>d&&(leftTower[b].treatment="dynamic");for(b=0;b<rightTower.length;b++)d=getH(rightTower[b]),viewHeight-rightTower[b].state.pos.y>d&&(rightTower[b].treatment="dynamic")}},drawHook=function(b){!0===hookload&&(!1===b?(b=getH(hookBox),hookBox.state.pos.y=b+hook.state.pos.y,hookBox.state.pos.x=hook.state.pos.x):(b=getH(hookBox),hookBox.state.pos.y=b*Math.cos(hookBox.state.angular.pos)+
2*b/5,hookBox.state.pos.x=-1*b*Math.sin(hookBox.state.angular.pos)+hook.state.pos.x,hookBox.state.angular.pos=hook.state.angular.pos-Math.PI/2),drawBody(hookBox,hookBox.view,ctx,hookBox.offset));drawBody(hook,hook.view,ctx,hook.offset)},moveHook=function(b){if(!1===b){if(hook.state.pos.x+=hookMoveSpeed,630<=hook.state.pos.x||150>=hook.state.pos.x)hookMoveSpeed*=-1}else{hook.state.pos.x+=hookMoveSpeed;hook.state.angular.pos+=hookAngleSpeed;if(630<=hook.state.pos.x||150>=hook.state.pos.x)hookMoveSpeed*=
-1;if(2<=hook.state.angular.pos||1>=hook.state.angular.pos)hookAngleSpeed*=-1}},send=function(){document.getElementById("input").blur();document.getElementById("input").disabled=!0;for(var b="",d=0;d<inputBox.length;d++)b+=inputBox[d];for(d=6;d>=rankSite;d--)Cookies.set("theRank"+d.toString(),Cookies.getJSON("theRank"+(d-1).toString()));Cookies.set("theRank"+rankSite,{name:b,score:total});isShowConfirm=!1},showConfirm=function(){document.getElementById("input").disabled=!1;document.getElementById("input").focus();
ctx.drawImage(getImage("input"),310,400,360,45);ctx.drawImage(getImage("confirm"),585,410,66,28);"confirm"===mouseOver&&ctx.drawImage(getImage("confirm2"),585,410,66,28);document.onkeypress=function(){var b=inputBox.length;"8"==event.keyCode&&0<b?inputBox.splice(b-1,b):13==event.keyCode?send():8>=b&&(b=String.fromCharCode(event.keyCode),inputBox.push(b))};document.onkeydown=function(){var b=inputBox.length;"8"==event.keyCode&&0<b&&inputBox.splice(b-1,b)};for(var b=0;b<inputBox.length;b++)ctx.fillText(inputBox[b],
345+25*b,430,100,100)},toRank=function(){total=parseInt(Cookies.get("stage1"))+parseInt(Cookies.get("stage2"))+parseInt(Cookies.get("stage3"))+parseInt(Cookies.get("stage4"))+parseInt(Cookies.get("stage5"));if(void 0===Cookies.get("theRank1")||null===Cookies.get("theRank1"))Cookies.set("theRank0",{name:"boss",score:99999}),Cookies.set("theRank1",{name:"king",score:35}),Cookies.set("theRank2",{name:"happycat",score:30}),Cookies.set("theRank3",{name:"francis",score:25}),Cookies.set("theRank4",{name:"Amy",
score:20}),Cookies.set("theRank5",{name:"123",score:15}),Cookies.set("theRank6",{name:"handsome",score:10});for(var b=0;5>=b;b++)if(parseInt(Cookies.getJSON("theRank"+b.toString()).score)>=total&&total>parseInt(Cookies.getJSON("theRank"+(b+1).toString()).score)){isShowConfirm=!0;rankSite=b+1;break}},toWin=function(){!1===winSound&&document.getElementById("win").play();isWin=winSound=!0;ctx.drawImage(getImage("win"),210,100,419,304);"next"===mouseOver?ctx.drawImage(getImage("next2"),270,420,252,81):
ctx.drawImage(getImage("next"),270,420,252,81);clearTimeout(reloadTimer);clearTimeout(countTimer);clearTimeout(addHeightTimer);clearTimeout(addLeftHeightTimer);clearTimeout(addRightHeightTimer);saveData()},toGameOver=function(){!1===failSound&&document.getElementById("fail").play();isGameOver=failSound=!0;ctx.drawImage(getImage("fail"),210,200,364,117);"again"===mouseOver?ctx.drawImage(getImage("again2"),270,360,252,81):ctx.drawImage(getImage("again"),270,360,252,81);clearTimeout(countTimer);clearTimeout(addHeightTimer);
clearTimeout(addLeftHeightTimer);clearTimeout(addRightHeightTimer)},addHeight=function(){!1===isGameOver&&(0<remainHeight?(nowHeight+=1,--remainHeight):clearTimeout(addHeightTimer),nowHeight>=goalHeight&&(isWin=!0))},addLeftHeight=function(){!1===isGameOver&&(0<remainLeftHeight?(nowLeftHeight+=1,--remainLeftHeight):clearTimeout(addLeftHeightTimer),nowLeftHeight>=goalHeight&&nowRightHeight>=goalHeight&&(isWin=!0))},addRightHeight=function(){!1===isGameOver&&(0<remainRightHeight?(nowRightHeight+=1,
--remainRightHeight):clearTimeout(addRightHeightTimer),nowLeftHeight>=goalHeight&&nowRightHeight>=goalHeight&&(isWin=!0))},getH=function(b){var d=b.geometry.height;void 0===b.geometry.height&&(d=75);return d},boxTouch=function(){var b=getH(hookBox);if(1===amount&&!1===isBoxTouch){if(!(2>=boxList.length)&&boxList[boxList.length-1].state.pos.y>=hookBox.state.pos.y+b&&0===boxList[boxList.length-1].state.vel.y&&0===boxList[boxList.length-1].state.angular.vel){for(var b=0,d=2;d<boxList.length;d++)b+=boxList[d].size;
remainHeight=b-nowHeight;addHeightTimer=setInterval(addHeight,70);isBoxTouch=!0}}else if(2===amount){if(2<leftTower.length&&leftTower[leftTower.length-1].state.pos.y>=hookBox.state.pos.y+b&&0===leftTower[leftTower.length-1].state.vel.y&&0===leftTower[leftTower.length-1].state.angular.vel){for(var g=0,d=2;d<leftTower.length;d++)g+=leftTower[d].size;remainLeftHeight=g-nowLeftHeight;addLeftHeightTimer=setInterval(addLeftHeight,70)}if(2<rightTower.length&&rightTower[rightTower.length-1].state.pos.y>=
hookBox.state.pos.y+b&&0===rightTower[rightTower.length-1].state.vel.y&&0===rightTower[rightTower.length-1].state.angular.vel){b=0;for(d=2;d<rightTower.length;d++)b+=rightTower[d].size;remainRightHeight=b-nowRightHeight;addRightHeightTimer=setInterval(addRightHeight,70)}}},checkBox=function(){if(1===amount){if(!(2>=boxList.length))for(var b=2;b<boxList.length;b++){var d=getH(boxList[b]);if(boxList[b].state.pos.y>=viewHeight-d/2&&"static"!==boxList[b].treatment){toGameOver();break}}}else if(2===amount&&
!(2>=leftTower.length&&2>=rightTower.length))if(leftTower.length>rightTower.length+3||leftTower.length+3<rightTower.length)toGameOver();else{for(b=2;b<leftTower.length;b++)if(d=getH(leftTower[b]),leftTower[b].state.pos.y>=viewHeight-d/2&&"static"!==leftTower[b].treatment){toGameOver();return}for(b=2;b<rightTower.length;b++)if(d=getH(rightTower[b]),rightTower[b].state.pos.y>=viewHeight-d/2&&"static"!==rightTower[b].treatment){toGameOver();return}d=getH(leftMax);b=getH(rightMax);(leftMax.state.pos.y>=
viewHeight+d||rightMax.state.pos.y>=viewHeight+b)&&toGameOver()}},reloadHook=function(){var b=getH(hookBox);hookBox=!1===detectPoly(nextBox)?createBox("rectangle",hook.state.pos.x,hook.state.pos.y,boxType[nextBox].width,boxType[nextBox].height,"static",getImage(nextBox)):createPoly("convex-polygon",nextBox,hook.state.pos.x,hook.state.pos.y,boxType[nextBox].width,boxType[nextBox].height,"static",getImage(nextBox));hookBox.restitution=0;hookBox.cof=3;hookBox.label="box";hookBox.state.pos.y=b+hook.state.pos.y;
hookBox.state.vel.y=0;hookBox.size=boxType[nextBox].size;hookload=!0;randomBox();hook.view=getImage("hook")},drawBox=function(){if(1===amount)for(var b=0;b<boxList.length;b++)850>boxList[b].state.pos.y&&drawBody(boxList[b],boxList[b].view,ctx,boxList[b].offset);else{for(b=0;b<leftTower.length;b++)850>leftTower[b].state.pos.y&&drawBody(leftTower[b],leftTower[b].view,ctx,leftTower[b].offset);for(b=0;b<rightTower.length;b++)850>rightTower[b].state.pos.y&&drawBody(rightTower[b],rightTower[b].view,ctx,
rightTower[b].offset)}},fixBoxCollision=function(){},initMouseMove=function(b){document.body.style.cursor="default"},setCanvas=function(){c=SlEEPBAG.canvasAutoResizer.getGameCanvas();resulotion=SlEEPBAG.canvasAutoResizer.getResolution();width=c.width;height=c.height;ctx=c.getContext("2d");ctx.clearRect(-1*width,-1*height,2*width,2*height);SlEEPBAG.canvasAutoResizer.setCenter();ctx.font="30px Arial"},addBox=function(b){!0===hookload&&(hook.view=getImage("hook2"),hookload=isBoxTouch=isPush=!1,hookBox.treatment=
"dynamic",hookBox.state.vel.x=0,hookBox.state.vel.y=0,hookBox.state.acc.y=0,hookBox.size=boxType[nextBox].size,world.add(hookBox),1===amount?boxList.push(hookBox):Math.abs(hookBox.state.pos.x-leftMax.state.pos.x)<=Math.abs(hookBox.state.pos.x-rightMax.state.pos.x)?(leftMax=hookBox,leftTower.push(hookBox)):(rightMax=hookBox,rightTower.push(hookBox)),reloadTimer=setTimeout(reloadHook,2E3))},toNext=function(){"stage1"===nowPage?nowPage="stage2":"stage2"===nowPage?nowPage="stage3":"stage3"===nowPage?
nowPage="stage4":"stage4"===nowPage&&(nowPage="stage5")},showTeach=function(){"stage2"===nowPage?(ctx.drawImage(getImage("teach2"),172,200,431,149),"start"===mouseOver?ctx.drawImage(getImage("start2"),315,400,146,64):ctx.drawImage(getImage("start"),315,400,146,64)):"stage3"===nowPage?(ctx.drawImage(getImage("teach3"),172,200,431,149),"start"===mouseOver?ctx.drawImage(getImage("start2"),315,400,146,64):ctx.drawImage(getImage("start"),315,400,146,64)):"stage4"===nowPage?(ctx.drawImage(getImage("teach4"),
172,200,431,149),"start"===mouseOver?ctx.drawImage(getImage("start2"),315,400,146,64):ctx.drawImage(getImage("start"),315,400,146,64)):"stage5"===nowPage&&(ctx.drawImage(getImage("teach5"),172,200,431,149),"start"===mouseOver?ctx.drawImage(getImage("start2"),315,400,146,64):ctx.drawImage(getImage("start"),315,400,146,64))},gameWinMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,
e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-447*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="pointer",mouseOver="next",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},gameWinMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,
e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-447*e/780-(h-e)/2)<=40*e/780?"stage5"===nowPage?(toRank(),nowPage="rank"):(toNext(),mouseOver="none",resetAll()):mouseOver="none"},gameOverMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-386*e/780-
(h-e)/2)<=41*e/780?(document.body.style.cursor="pointer",mouseOver="again",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},gameOverMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-
386*e/780-(h-e)/2)<=41*e/780?(isGameOver=!1,mouseOver="none",resetAll()):mouseOver="none"},drawBackGroundRight=function(){1===amount?(void 0===backGroundRightOneCtx.cache&&(backGroundRightOneCanvas.width=172,backGroundRightOneCanvas.height=780,backGroundRightOneCtx.drawImage(getImage("game_bg_2"),0,0,172,780),backGroundRightOneCtx.cache=!0),ctx.drawImage(backGroundRightOneCanvas,c.width/2-470+768,0,172,780)):(void 0===backGroundRightTwoCtx.cache&&(backGroundRightTwoCanvas.width=172,backGroundRightTwoCanvas.height=
780,backGroundRightTwoCtx.drawImage(getImage("game_bg2_2"),0,0,172,780),backGroundRightTwoCtx.cache=!0),ctx.drawImage(backGroundRightTwoCanvas,c.width/2-470+768,0,172,780))},drawBackGroundLeft=function(){1===amount?(void 0===backGroundLeftOneCtx.cache&&(backGroundLeftOneCanvas.width=800,backGroundLeftOneCanvas.height=780,backGroundLeftOneCtx.drawImage(getImage("game_bg_1"),19,0,768,780),backGroundLeftOneCtx.cache=!0),ctx.drawImage(backGroundLeftOneCtx.canvas,0,0)):(void 0===backGroundLeftTwoCtx.cache&&
(backGroundLeftTwoCanvas.width=800,backGroundLeftTwoCanvas.height=780,backGroundLeftTwoCtx.drawImage(getImage("game_bg2_1"),19,0,768,780),backGroundLeftTwoCtx.cache=!0),ctx.drawImage(backGroundLeftTwoCtx.canvas,0,0))},stageAllSet=function(){!0===FirstEnterPage&&randomBox();drawBackGroundLeft();addFloor();drawBox();drawBackGroundRight();fixBoxCollision();showNext();showTime();showNowHeight();showGoalHeight();showGoalTag();showNowTag();showTag();showBlock();showStage()},toTeachingMouseOver=function(b){var d=
getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-872*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="pointer",mouseOver="start",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-175*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor=
"pointer",mouseOver="return",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},toTeachingMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-872*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor=
"default",mouseOver="none",isTeaching=!1,beginCountTime()):Math.abs(b-175*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="default",nowPage="newGame"):mouseOver="none"},toTeachMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-872*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/
780-(h-e)/2)<=31*e/780?(document.body.style.cursor="pointer",mouseOver="start",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-386*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="pointer",mouseOver="teach",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-175*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="pointer",mouseOver="return",
!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},toTeachMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-872*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="default",mouseOver=
"none",isTeaching=isTeach=!1,beginCountTime()):Math.abs(b-395*f/978-(g-f)/2)<=128*f/978&&Math.abs(d-386*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="default",toTeaching()):Math.abs(b-175*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-708*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="default",nowPage="newGame"):mouseOver="none"},toTeach=function(){ctx.drawImage(getImage("start"),800,690,146,64);ctx.drawImage(getImage("return"),100,690,146,64);ctx.drawImage(getImage("teach_button"),270,360,252,
81);"teach"===mouseOver?ctx.drawImage(getImage("teach_button2"),270,360,252,81):"return"===mouseOver?ctx.drawImage(getImage("return2"),100,690,146,64):"start"===mouseOver&&ctx.drawImage(getImage("start2"),800,690,146,64)},toTeaching=function(){isTeach=!1;isTeaching=!0;ctx.drawImage(getImage("teach"),19,0,940,780);ctx.drawImage(getImage("return"),100,690,146,64);ctx.drawImage(getImage("start"),800,690,146,64);"start"===mouseOver?ctx.drawImage(getImage("start2"),800,690,146,64):"return"===mouseOver&&
ctx.drawImage(getImage("return2"),100,690,146,64)},toGame=function(){checkBox();moveUp()},toFrame=function(){!0===isGameOver?(setMouseEvent(gameOverMouseOver,gameOverMouseClick),toGameOver()):!0===isWin?(setMouseEvent(gameWinMouseOver,gameWinMouseClick),toWin()):(setMouseEvent(initMouseMove,addBox),toGame())},rankMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,
e=getRatio(g,h),f=e.w,e=e.h;!0===isShowConfirm&&Math.abs(b-612*f/978-(g-f)/2)<=33*f/978&&Math.abs(d-408*e/780-(h-e)/2)<=14*e/780?(document.body.style.cursor="pointer",mouseOver="confirm",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-470*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-630*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor="pointer",mouseOver="return",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor=
"default",mouseOver="none")},rankMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;!0===isShowConfirm&&Math.abs(b-612*f/978-(g-f)/2)<=33*f/978&&Math.abs(d-408*e/780-(h-e)/2)<=14*e/780?(document.body.style.cursor="default",send()):Math.abs(b-470*f/978-(g-f)/2)<=72*f/978&&Math.abs(d-630*e/780-(h-e)/2)<=31*e/780?(document.body.style.cursor=
"default",nowPage="index"):mouseOver="none";!0===isShowConfirm&&document.getElementById("input").focus()},indexMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-310*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="pointer",mouseOver="new",!1===buttonSound&&(document.getElementById("button").play(),
buttonSound=!0)):Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-403*e/780-(h-e)/2)<=40*e/780?!0===isContinue&&(document.body.style.cursor="pointer",mouseOver="continue",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-503*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="pointer",mouseOver="rank",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor=
"default",mouseOver="none")},indexMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-310*e/780-(h-e)/2)<=40*e/780?nowPage="newGame":Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-403*e/780-(h-e)/2)<=40*e/780?!0===isContinue&&(document.body.style.cursor="default",nowPage=
"continueGame"):Math.abs(b-474*f/978-(g-f)/2)<=126*f/978&&Math.abs(d-503*e/780-(h-e)/2)<=40*e/780?(document.body.style.cursor="default",nowPage="rank"):mouseOver="none"},newGameMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-365*f/978-(g-f)/2)<=84*f/978&&Math.abs(d-660*e/780-(h-e)/2)<=35*e/780?(document.body.style.cursor=
"pointer",mouseOver="return",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-600*f/978-(g-f)/2)<=84*f/978&&Math.abs(d-660*e/780-(h-e)/2)<=35*e/780?(document.body.style.cursor="pointer",mouseOver="continue",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(document.body.style.cursor="default",buttonSound=!1,mouseOver="none")},newGameMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,
h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-365*f/978-(g-f)/2)<=84*f/978&&Math.abs(d-660*e/780-(h-e)/2)<=35*e/780?(document.body.style.cursor="default",nowPage="index"):Math.abs(b-600*f/978-(g-f)/2)<=84*f/978&&Math.abs(d-660*e/780-(h-e)/2)<=35*e/780?(document.body.style.cursor="default",nowPage="stage1",resetAll()):mouseOver="none"},continueGameMouseOver=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,
h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-470*f/978-(g-f)/2)<=73*f/978&&Math.abs(d-668*e/780-(h-e)/2)<=30*e/780?(document.body.style.cursor="pointer",mouseOver="return",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-224*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage1")&&""!==Cookies.get("stage1")&&void 0!==Cookies.get("stage1")&&(document.body.style.cursor=
"pointer",mouseOver="stage1",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-472*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage2")&&""!==Cookies.get("stage2")&&void 0!==Cookies.get("stage2")&&(document.body.style.cursor="pointer",mouseOver="stage2",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-730*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==
Cookies.get("stage3")&&""!==Cookies.get("stage3")&&void 0!==Cookies.get("stage3")&&(document.body.style.cursor="pointer",mouseOver="stage3",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):Math.abs(b-318*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-505*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage4")&&""!==Cookies.get("stage4")&&void 0!==Cookies.get("stage4")&&(document.body.style.cursor="pointer",mouseOver="stage4",!1===buttonSound&&(document.getElementById("button").play(),
buttonSound=!0)):Math.abs(b-632*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-505*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage5")&&""!==Cookies.get("stage5")&&void 0!==Cookies.get("stage5")&&(document.body.style.cursor="pointer",mouseOver="stage5",!1===buttonSound&&(document.getElementById("button").play(),buttonSound=!0)):(buttonSound=!1,document.body.style.cursor="default",mouseOver="none")},continueGameMouseClick=function(b){var d=getMouseSite(b);b=d.x;var d=d.y,g=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientWidth,
h=SlEEPBAG.canvasAutoResizer.getGameArea().parentNode.clientHeight,e=getRatio(g,h),f=e.w,e=e.h;Math.abs(b-470*f/978-(g-f)/2)<=73*f/978&&Math.abs(d-668*e/780-(h-e)/2)<=30*e/780?(document.body.style.cursor="default",nowPage="index",mouseOver="none"):Math.abs(b-224*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage1")&&""!==Cookies.get("stage1")&&void 0!==Cookies.get("stage1")&&(document.body.style.cursor="default",nowPage="stage1",mouseOver="none",resetAll()):
Math.abs(b-472*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage2")&&""!==Cookies.get("stage2")&&void 0!==Cookies.get("stage2")&&(document.body.style.cursor="default",nowPage="stage2",mouseOver="none",resetAll()):Math.abs(b-730*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-280*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage3")&&""!==Cookies.get("stage3")&&void 0!==Cookies.get("stage3")&&(document.body.style.cursor="default",nowPage="stage3",mouseOver="none",resetAll()):
Math.abs(b-318*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-505*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage4")&&""!==Cookies.get("stage4")&&void 0!==Cookies.get("stage4")&&(document.body.style.cursor="default",nowPage="stage4",mouseOver="none",resetAll()):Math.abs(b-632*f/978-(g-f)/2)<=115*f/978&&Math.abs(d-505*e/780-(h-e)/2)<=90*e/780?null!==Cookies.get("stage5")&&""!==Cookies.get("stage5")&&void 0!==Cookies.get("stage5")&&(document.body.style.cursor="default",nowPage="stage5",mouseOver="none",resetAll()):
mouseOver="none"},newGame=function(){setMouseEvent(newGameMouseOver,newGameMouseClick);ctx.drawImage(getImage("teach_bg"),c.width/2-470,0,940,780);ctx.drawImage(getImage("new_return"),280,650,168,71);ctx.drawImage(getImage("new_continue"),520,650,168,71);ctx.drawImage(getImage("shovel"),730,580,155,174);"return"===mouseOver?ctx.drawImage(getImage("new_return2"),280,650,168,71):"continue"===mouseOver&&ctx.drawImage(getImage("new_continue2"),520,650,168,71)},continueGame=function(){setMouseEvent(continueGameMouseOver,
continueGameMouseClick);ctx.drawImage(getImage("lv_bg"),c.width/2-470,0,940,780);ctx.drawImage(getImage("return"),400,660,146,61);null!==Cookies.get("stage1")&&""!==Cookies.get("stage1")&&void 0!==Cookies.get("stage1")?ctx.drawImage(getImage("lv1"),100,200,233,179):ctx.drawImage(getImage("lv1_3"),100,200,233,179);null!==Cookies.get("stage2")&&""!==Cookies.get("stage2")&&void 0!==Cookies.get("stage2")?ctx.drawImage(getImage("lv2"),360,200,233,179):ctx.drawImage(getImage("lv2_3"),360,200,233,179);null!==
Cookies.get("stage3")&&""!==Cookies.get("stage3")&&void 0!==Cookies.get("stage3")?ctx.drawImage(getImage("lv3"),620,200,233,179):ctx.drawImage(getImage("lv3_3"),620,200,233,179);null!==Cookies.get("stage4")&&""!==Cookies.get("stage4")&&void 0!==Cookies.get("stage4")?ctx.drawImage(getImage("lv4"),200,430,233,179):ctx.drawImage(getImage("lv4_3"),200,430,233,179);null!==Cookies.get("stage5")&&""!==Cookies.get("stage5")&&void 0!==Cookies.get("stage5")?ctx.drawImage(getImage("lv5"),520,430,233,179):ctx.drawImage(getImage("lv5_3"),
520,430,233,179);"return"===mouseOver?ctx.drawImage(getImage("return2"),400,660,146,61):"stage1"===mouseOver&&null!==Cookies.get("stage1")&&""!==Cookies.get("stage1")&&void 0!==Cookies.get("stage1")?ctx.drawImage(getImage("lv1_2"),100,200,233,179):"stage2"===mouseOver&&null!==Cookies.get("stage2")&&""!==Cookies.get("stage2")&&void 0!==Cookies.get("stage2")?ctx.drawImage(getImage("lv2_2"),360,200,233,179):"stage3"===mouseOver&&null!==Cookies.get("stage3")&&""!==Cookies.get("stage3")&&void 0!==Cookies.get("stage3")?
ctx.drawImage(getImage("lv3_2"),620,200,233,179):"stage4"===mouseOver&&null!==Cookies.get("stage4")&&""!==Cookies.get("stage4")&&void 0!==Cookies.get("stage4")?ctx.drawImage(getImage("lv4_2"),200,430,233,179):"stage5"===mouseOver&&null!==Cookies.get("stage5")&&""!==Cookies.get("stage5")&&void 0!==Cookies.get("stage5")&&ctx.drawImage(getImage("lv5_2"),520,430,233,179)},showPig=function(){50<pigIndex?ctx.drawImage(getImage("pig2"),600,200,298,431):ctx.drawImage(getImage("pig"),600,200,298,431);100<
pigIndex&&(pigIndex=0)},index=function(){setMouseEvent(indexMouseOver,indexMouseClick);ctx.drawImage(getImage("index"),c.width/2-470,0,940,780);ctx.drawImage(getImage("new"),350,280,252,81);ctx.drawImage(getImage("continue"),350,380,252,81);ctx.drawImage(getImage("rank"),350,480,252,81);showPig();pigIndex++;"new"===mouseOver?ctx.drawImage(getImage("new2"),350,280,252,81):"continue"===mouseOver?ctx.drawImage(getImage("continue2"),350,380,252,81):"rank"===mouseOver&&ctx.drawImage(getImage("rank2"),
350,480,252,81)},rank=function(){setMouseEvent(rankMouseOver,rankMouseClick);ctx.drawImage(getImage("rank_bg"),c.width/2-470,0,940,780);ctx.drawImage(getImage("return"),400,625,146,64);"return"===mouseOver&&ctx.drawImage(getImage("return2"),400,625,146,64);ctx.font="bold 40px Microsoft JhengHei";ctx.fillStyle="brown";ctx.fillText("\u6392\u540d",300,280,100,100);ctx.fillText("\u540d\u7a31",430,280,100,100);ctx.fillText("\u5206\u6578",560,280,100,100);ctx.font="bold 30px Microsoft JhengHei";ctx.fillStyle=
"black";for(var b=1;6>=b;b++){var d=Cookies.getJSON("theRank"+b);ctx.fillText(b,328,280+50*b,100,100);ctx.fillText(d.name,430,280+50*b,100,100);ctx.fillText(d.score,580,280+50*b,100,100)}ctx.font="30px Arial";!0===isShowConfirm&&showConfirm()},Stage1=function(){stageAllSet();initFirstBox();drawHook(!1);moveHook(!1);boxTouch();!0===isTeach?(setMouseEvent(toTeachMouseOver,toTeachMouseClick),toTeach()):!0===isTeaching?(setMouseEvent(toTeachingMouseOver,toTeachingMouseClick),toTeaching()):toFrame();FirstEnterPage=
!1},Stage2=function(){stageAllSet();initFirstBox();drawHook(!1);moveHook(!1);boxTouch();!0===isTeach?(setMouseEvent(showTeachMouseOver,showTeachMouseClick),showTeach()):toFrame();FirstEnterPage=!1},Stage3=function(){stageAllSet();initFirstBox();drawHook(!1);moveHook(!1);boxTouch();!0===isTeach?(setMouseEvent(showTeachMouseOver,showTeachMouseClick),showTeach()):toFrame();fixLeftAndRight();FirstEnterPage=!1},Stage4=function(){stageAllSet();initFirstBox();drawHook(!0);moveHook(!0);boxTouch();!0===isTeach?
(setMouseEvent(showTeachMouseOver,showTeachMouseClick),showTeach()):toFrame();FirstEnterPage=!1},Stage5=function(){stageAllSet();initFirstBox();drawHook(!0);moveHook(!0);boxTouch();!0===isTeach?(setMouseEvent(showTeachMouseOver,showTeachMouseClick),showTeach()):toFrame();FirstEnterPage=!1;fixLeftAndRight()},changePage=function(){requestAnimationFrame(changePage);"index"===nowPage?index():"rank"===nowPage?rank():"continueGame"===nowPage?continueGame():"newGame"===nowPage?newGame():"stage1"===nowPage?
Stage1():"stage2"===nowPage?Stage2():"stage3"===nowPage?Stage3():"stage4"===nowPage?Stage4():"stage5"===nowPage&&Stage5()};window.addEventListener("load",function(){FastClick.attach(document.body)},!1);init();